# fetch、axios、ajax 区别

参考：https://www.jianshu.com/p/8bc48f8fde75

目录：
* 原生 XMLHttpRequest
* Ajax
* Fetch
* Axios
* 总结

## 一、浏览器 原生 XMLHttpRequest
参考：[XMLHttpRequest 详细介绍](./5.1__xhr.md)

```js
const xhr = new XMLHttpRequest();
    
xhr.open("GET", url, false); // 第三个字段：true（异步）、false（同步）
xhr.setRequestHeader("Content-Type", "application/json");
xhr.onreadystatechange = function () {
    if (xhr.readyState !== 4) return;
    if (xhr.status === 200 || xhr.status === 304) {
        // 
    } else {
        // 
    }
};

xhr.send();
```

## 2. Ajax
Ajax 不是具体的API，而是一种技术概念（异步请求数据的思想）。

Ajax 允许网页在**不重新加载整个页面的情况下，通过异步方式与服务器交换数据并更新部分网页内容**。早期，主要通过原生 XMLHttpRequest 来实现。

实现Ajax的方式有很多：原生XMLHttpRequest、JQuery ajax、Fetch、Axios等

以 JQuery ajax 为例，它 是对原生XHR的封装，除此以外还增添了对JSONP的支持。

**用法**：
```js
$.ajax({
    type: 'POST',
    url: url,
    data: data,
    dataType: dataType,
    success: function() {},
    error: function() {}
});

```

**优点**：
* **无需重新加载整个网页的情况下，可以只对网页中的某一部分进行更新**。
* 使用**异步**的方式**与服务器通信**，不需要中断操作，
* **避免**客户端浏览器在**开始渲染之前等待所有数据到达**，节省网络带宽。
* **交互性好**，提升了用户体验。

**缺点**：
* 本身是针对MVC的编程,不符合现在前端MVVM的浪潮
* 不符合**关注分离原则**（Separation of Concerns）
* AJAX **不支持 Back 和 History 功能**。 在动态更新页面的情况下，用户无法回到前一个页面状态，因为浏览器仅能记忆历史记录中的静态页面。


## 3. Axios
axios 是一个**基于Promise 用于浏览器和 nodejs 的 HTTP 客户端**，本质上也是**对原生XHR的封装**，只不过它是Promise的实现版本，符合最新的ES规范，它本身具有以下特征：

**用法**：
```js
axios({
    method: 'post',
    url: '/user/12345',
    data: {
        firstName: 'Fred',
        lastName: 'Flintstone'
    }
})
.then(function (response) {
    console.log(response);
})
.catch(function (error) {
    console.log(error);
});
```
**优点**：
* 从node.js创建http请求
* 在浏览器中创建XMLHttpRequest
* 支持Promise API
* 提供了一些**并发请求的接口**
* 支持**拦截**请求和响应
* **转换**请求和响应数据
* **取消**请求
* 自动转换JSON数据
* 客户端**支持防御CSRF/XSRF**
> 防止CSRF：就是**让你的每个请求都带一个从cookie中拿到的key**, 根据浏览器同源策略，**假冒的网站是拿不到你cookie中得key的**，这样，后台就可以**轻松辨别出这个请求是否是用户在假冒网站上的误导输入**，从而采取正确的策略


## 4. Fetch
参考：[Fetch详解](./5.2__Fetch.md)

## 5. 总结
**axios既提供了并发的封装，也没有fetch的各种问题，而且体积也较小，当之无愧现在最应该选用的请求的方式**