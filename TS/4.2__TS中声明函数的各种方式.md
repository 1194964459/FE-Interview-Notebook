# TS中声明函数的各种方式

TS中```:```、```=>```分别有什么用？ 
1. ```:``` 用于给“具体实现”中的的参数、返回值或“类型声明”中的变量标注类型   
2. ```=>```在TS的“类型声明”中，用于定义函数类型的结构（```参数类型 → 返回值类型```），是 TS 中函数类型的专用语法

## 一、注意区分：函数的类型声明、函数实现中的类型标注（或值声明、类型声明）

* 类型声明：仅在编译阶段有用，编译后就不存在了。通常适用于描述第三方库函数、团队协作（先定接口、再定实现）、复用函数类型的情况(可能不止一个函数对参数、返回值的限制是这样的)

* 函数实现中的类型标注：含具体的实现代码，编译后除了类型标注外 其他实现逻辑保留下来了。这种做法在开发过程中是最常见的。

### 1. 函数的类型声明（纯类型描述，无实现）
用 declare function、类型别名（type）或接口（interface）描述函数的参数类型和返回值类型，**不包含任何执行逻辑**。
```js
// 类型声明（仅描述类型，无实现）
declare function add(a: number, b: number): number; // 全局函数的类型声明

type MultiplyFn = (x: number, y: number) => number; // 用类型别名定义函数类型
```
编译后不存在了，通常用于描述第三方库函数。

### 2. 函数实现中的类型标注（带类型的具体代码）
在写函数实现时（普通函数或箭头函数），给参数和返回值加 ```: 类型``` 标注，**包含执行逻辑**。
```js
// 函数实现（带类型标注，有具体逻辑）
function add(a: number, b: number): number { // 实现中的类型标注
  return a + b; // 具体逻辑
}
```
编译后执行代码还存在的

## 二、函数声明的几种方式
（一）直接声明带实现的函数，也称作“值声明”（最常用）  
分两种：具名函数、函数表达式，然后每种类型在实现时又分几种情况：
* 是赋值(=)前声明类型？还是赋值后声明？两个只要有一个声明即可，当然赋值前、后也可以一起声明，就是麻烦点。
* 若是赋值后声明，参数是一定要有类型的，返回值的类型可有、可无，因为TS会进行类型推导！不过最好给返回值也设置类型。

（二）仅声明函数类型，也称作“类型声明”（无实现）  
分别有4种：declare function声明、type声明、interface声明、声明一个值（值是个函数）。

1. ```用declare function 声明函数类型```时，注意**必须用 : 分隔开参数列表和返回值类型**，而不是 =>。     
    
    ```js
        declare function Add(a: number, b: number)=> number;   // 错误 ❌

        declare function Add(a: number, b: number): number;  // 正确 ✅
    ```
2. interface中声明函数时的几种情况： 
参考：[interface中定义函数](./interface中定义函数.md)
    ```js
    interface MathFunction {
        // (a: number, b: number)=> number;  // 错误❌
        (a: number, b: number): number;  // 正确 ✅，函数签名，MathFunction可直接作为一个函数使用，这种一般用的比较少！
        func: (a: number, b: number) => number;  // 属性func是个函数
        multiply(a: number, b: number): number; // 另一种语法（等价于func）
    }
    ```
3. type声明函数：
    ```js
    type func = (a: number, b: number) => number;
    ```
4. 声明一个值，这个值是个函数
    ```js
    declare let Add: (a: number, b: number) => number;    //  Add(1,2)
    ```

## 三、疑问❓
1. 实现过程中的类型标注是必须的吗？
答：不是必须的。但如果没有标注，TS 会 进行**类型推断**：参数默认推断为 any（严格模式下会报错，建议显式标注），返回值根据函数体进行推断。
```js
// 无任何类型标注，TS 会推断参数为 any（非严格模式），返回值为 number
function add(a, b) {
  return a + b;
}
```
2. 可以只在实现中标注？不搞专门的类型声明吗？
答：**完全可以**，这是最常见的做法！

3. 可以只搞专门的类型声明，不在实现中标注吗？
    * 答：**也可以**，但需要确保实现的函数符合类型声明的规则。这种方式适合的场景：
        * 尤其适合团队协作（先定接口，再写实现）
        * 复用函数类型：多个函数需要遵循相同的参数/返回值规则时，用类型别名（type）定义一次，避免重复标注。
    ```js
    // 先定义类型声明（契约）
    type DivideFn = (a: number, b: number) => number;

    // 实现函数时不单独标注，依赖类型声明约束
    const divide: DivideFn = (a, b) => a / b; // TS 会自动检查 a、b 必须是 number
    ```
4. 我们注意到：函数类型声明中有```=>```，函数实现中也有```=>```，两者一样吗？区别是啥？
    * **箭头函数实现中**：```=>``` 是 **JS 语法**，```:```才是 **TS 类型标注**
        * ```=>``` 是 JavaScript 箭头函数的固有有语法，作用是**连接参数列表和函数体（和类型无关）**；
        * ```:``` 才是 TypeScript 用于标注返回值类型的符号。
    ```js
        // 箭头函数实现
        const add = (a: number, b: number): number => a + b;
        //          ^^^^^^^^────参数类型标注（用 :）           ↑
        //                               ↓
        //                    返回返回值类型标注（用 :）  ↑
        //                                 ↓
        //                        JS 箭头函数语法（用 => 连接参数和函数体）
    ```
    
    * **箭头函数的类型声明**（TS 类型层面）:
    ```ts
        // 这是“函数类型”的声明（描述函数应该是什么样）
        type AddFunction = (a: number, b: number) => number;
        //                                       ↑
        //                TS 中用 => 分隔参数类型和返回值类型（类型层面）
    ```
    这里的```=>```是 **TS 语法**，用于**在类型层面 分隔参数类型和返回值类型**。

5. 以下两种写法完全等价（**返回值类型都用 : 标注**）：
    ```JS
    // 普通函数
    function add(a: number, b: number): number { return a + b; }

    // 箭头函数
    const add = (a: number, b: number): number => a + b;
    ```
6. 函数的“定义形态”与“类型声明”    

    在 TypeScript 中，**函数的 “定义形式”（普通函数还是箭头函数）与 “类型声明” 是相互独立的**。类型声明描述的是函数的 “参数类型” 和 “返回值类型”，与函数是用普通函数还是箭头函数定义无关。

    简单说：**无论函数是普通函数还是箭头函数，只要它们的参数类型和返回值类型一致，就可以共用用同一个类型声明**。

7. 如果你在**赋值语句的一边指定了类型**但是**另一边没有类型**的话，TypeScript编译器会自动识别出类型：

    函数参数声明类型了，返回值不一定需要声明类型的（具体看函数功能、逻辑，不过最好声明上），有的返回值 可以根据参数直接推导！

## 四、以箭头函数为例，如何声明一个箭头函数？
箭头函数通常会赋值给个变量，只用考虑：是在```=```后声明类型？还是```=```前声明?

1. ```= 后声明类型```：即在箭头函数中操作（简洁写法）  
在箭头函数的参数会直接标注类型，返回值类型可省略（TS 会自动推断，也可显式标注）。

```js
// 显式声明参数类型，返回值类型自动推断（number）
const add = (a: number, b: number) => a + b;
```

```js
// 显式声明参数类型和返回值类型（更严格）
const subtract = (x: number, y: number): number => x - y;
```

2. ```= 前声明类型```：此处是个函数类型的变量，然后再将箭头函数 赋值给变量（约束性写法）。TS中函数类型如何声明？```(参数类型) => 返回值类型```

这种操作，箭头函数的参数和返回值类型会被自动约束。
```js
// 先声明变量的函数类型
const multiply: (a: number, b: number) => number = 
  // 箭头函数参数类型和返回值类型被自动约束为 number
  (a, b) => a * b;

// 完整显式写法（参数和返回值类型都手动标注）
const divide: (x: number, y: number) => number = 
  (x: number, y: number): number => x / y;
```
3. 使用类型别名（复用函数类型）
当多个箭头函数需要遵循相同的类型规则时，用 type 定义类型别名，提高复用性。
```js
// 定义函数类型别名
type NumberOperation = (num1: number, num2: number) => number;

// 复用类型别名声明箭头函数
const power: NumberOperation = (base, exponent) => Math.pow(base, exponent);
const mod: NumberOperation = (a: number, b: number): number => a % b;
```

4. 复杂场景：带可选参数、默认值或联合类型
箭头函数的类型声明支持处理可选参数、默认值、联合类型等复杂情况。
```js
// 可选参数（参数后加 ?）
const greet = (name?: string): string => `Hello, ${name || 'Guest'}`;

// 参数默认值（默认值类型需与声明类型一致）
const calculate = (a: number, b: number = 10): number => a * b;

// 联合类型参数
const formatValue = (value: string | number): string => {
  return typeof value === 'number' ? value.toFixed(2) : value;
};
```