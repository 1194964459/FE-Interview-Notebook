# 私有化

这样实现功能的同时，也方便模块交付，然后 私有化客户 要改动的东西也很清晰

## 一、package.json中的脚本
```js
"private-dev": "vite --mode private-dev",
"private-build": "vite build --mode private-prod",
"sony-dev": "vite --mode sony-dev",
"sony-build": "vite build --mode sony-prod",
```
## 二、环境配置：
TODO:为什么生产环境不需要配置：VITE_SERVER_HOST、VITE_SERVER_PORT？
.env.private-dev 文件配置：
```js
VITE_CLIENT_ID=sensespace
VITE_BASEPATH=sensespace
VITE_SERVER_HOST=space-private.sensetime.com
VITE_SERVER_PORT=30443
VITE_APP_USERNAME=liuzhen3@sensetime.com
VITE_APP_PASSWORD=St666888.

VITE_APP_BRAND=brand-private
```

.env.private-prod 文件配置：
```js
VITE_CLIENT_ID=sensespace
VITE_BASEPATH=sensespace
VITE_SERVER_HOST=
VITE_SERVER_PORT=
VITE_APP_USERNAME=
VITE_APP_PASSWORD=
VITE_APP_BRAND=brand-private
```

Sony开发环境：
```js
VITE_CLIENT_ID=sensespace
VITE_BASEPATH=dtplatform
VITE_SERVER_HOST=dt.mars-stage.com
VITE_APP_USERNAME=tangyangjian@sensetime.com
VITE_APP_PASSWORD=St666888.
VITE_APP_BRAND=brand-sony
```

## 三、public目录中配置对应的资源、文案
主要是想替换**登录页**中的图标、文案啥的

* 图片等资源文件：如：public/brand-sony/images/logo.png
* brand.js：
    * 配置具体的翻译文案：title、版权信息、私有话网址、用户协议、隐私政策等
    * logo路径

```js
// 固定的函数，用来获取路径
const path = (function(){})()

const i18nText = {
    zh:{
        brand:{
            title: "SenseSpace 商汤琼宇 中文中文",
            copyright:'© SenseTime',
            logo: path + 'images/logo.png',
        }
    },
     en:{
        brand:{
            title: "SenseSpace - Reconstruction platform",
            copyright:'© SenseTime',
            logo:  path + 'images/logo.png',
        }
    }
}


// 导出的配置
window.__BRAND__  = {
    i18nText,
    path,
}
```

将 私有化相关的国际化文案合并到 已有语言包：
```js
const { i18nText } = window.__BRAND__
Object.keys(i18nText).forEach(key => {
  i18n.global.mergeLocaleMessage(key, i18nText[key])
})
```

## index.html
html文件中访问 vue编译时的变量：```%VITE_XXX%``` 

根目录访问 public目录中 的文件
```js
// 标题
<title>%VITE_APP_TITLE%</title>

// logo
<link rel="icon" href="/%VITE_APP_BRAND%/favicon.ico" />

// 脚本
<script src="/%VITE_APP_BRAND%/brand.js?t=%VITE_APP_TIMESTAMP%"></script>
```