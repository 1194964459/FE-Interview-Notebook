# Promise是个宏任务？

```js
const promiseA = new Promise(
    resolve => setTimeout(() => resolve('A'), 100)
);
```
promiseA 是个微任务？还是宏任务？答：错了❌，promiseA是个Promise对象，Promise是用于承载异步状态和结果的容器。
setTimeout 是宏任务源，它的回调会被放入宏任务队列，等待 100ms 后执行。

promise 的 then/catch 注册的回调函数会被放入微任务队列，等待执行。

## Promise.then() 方法的执行时机
这里其实应该拆成2部分：
* Promise.then的执行时机：立即同步执行
* then注册的回调函数的执行时机：这个回调函数异步执行，且必须等待：
    * ① Promise 状态发生变化（成功 / 失败）；
    * ② 当前同步代码执行完毕；
    * 之后，作为微任务被执行。

## Promise相关的异步？还是同步？
* Promise 构造函数的回调是同步执行的；（需注意：其他回调都异步的哦！）
* Promise.resolve()、reject() 是同步执行的，它们的回调是异步执行的（微任务）
* Promise.then()、Promise.catch()是同步执行的，它们的回调是异步执行的（微任务）
* Promise.all()、Promise.allSettled()、Promise.race() 和 Promise.any()： 这些也一样的，它们本身是同步执行的，会返回一个Promise对象，但是其参数里的各项都是异步的

```js
const p = Promise.resolve().then(() => fn(item));
```
这里的 p 是谁？ Promise.resolve()是同步执行的，后面的then的回调是异步执行的。变量p 是then返回的新的 Promise 对象；

## Demo
[样例1](./code/promise微宏任务.js)

[样例2](./code/promise相关的宏任务微任务.js)


## new Promise中的resolve与then方法哪个先执行？
参考：[手写promise](./手写promise.md)

注意：then是同步执行的，then中的回调是异步执行的。

看resolve是在同步代码中调用？还是异步中调用（如：setTimeout）？

同步中调用，则resolve先执行；否则then先执行（注意：不是then的回调哦）
```js
const promise = new Promise((resolve) => {
  // 同步执行 resolve（没有异步操作）
  resolve(100); 
});
```

