# Ref

CreateRefï¼ˆç±»ç»„ä»¶ï¼‰ ä¸ useRefï¼ˆå‡½æ•°å¼ç»„ä»¶ï¼‰ï¼šä¸¤è€…éƒ½æ˜¯ç”¨äº**åˆ›å»ºå¼•ç”¨ï¼ˆrefï¼‰**æ¥**è®¿é—® DOM å…ƒç´  æˆ– å­˜å‚¨ç»„ä»¶ä¸­çš„å¯å˜å€¼**

éœ€æ³¨æ„ï¼š
* å‡½æ•°ç»„ä»¶æ— å®ä¾‹
* ref.currentä»…åœ¨ç»„ä»¶æŒ‚è½½åæ‰ä¼šæŒ‡å‘ DOM æˆ– ç»„ä»¶å®ä¾‹ï¼ŒæŒ‚è½½å‰ä¸ºnullï¼Œéœ€é¿å…åœ¨renderæˆ–useEffectï¼ˆæ— ä¾èµ–ï¼‰ä¸­ç›´æ¥è®¿é—®ã€‚

### ä¸€ã€æŒä¹…åŒ–
**ref çš„æŒä¹…åŒ–**ï¼š
ref å¯¹è±¡**åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¿æŒä¸å˜ï¼Œä¸ä¼šéšç€ç»„ä»¶çš„é‡æ–°æ¸²æŸ“è€Œè¢«é‡æ–°åˆ›å»º**ã€‚

ä¸ºä»€ä¹ˆéœ€è¦æŒä¹…åŒ–ï¼Ÿ
* **ç¨³å®šè®¿é—® DOM æˆ– ç»„ä»¶**ï¼šå¦‚æœ ref å¯¹è±¡*éšæ¸²æŸ“é‡æ–°åˆ›å»º*ï¼Œ*å¯èƒ½å¯¼è‡´åœ¨ç»„ä»¶æ›´æ–°åä¸¢å¤±å¯¹ DOM å…ƒç´ æˆ–ç»„ä»¶å®ä¾‹çš„å¼•ç”¨*ã€‚
* **å­˜å‚¨è·¨æ¸²æŸ“çš„æ•°æ®**ï¼šå¦‚å®šæ—¶å™¨ IDã€ç¬¬ä¸‰æ–¹åº“å®ä¾‹ç­‰ï¼Œè¿™äº›æ•°æ®éœ€è¦åœ¨ç»„ä»¶å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ä¿æŒä¸€è‡´ã€‚å°†å…¶å­˜å‚¨åˆ° ref.current å±æ€§ä¸Šï¼ŒuseRef æˆ– createRef çš„ current å±æ€§æ”¹å˜æ—¶ï¼Œéƒ½ä¸ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚


### äºŒã€useRefã€createRef
* **å‡½æ•°ç»„ä»¶ä¸­ï¼ˆuseRefï¼‰**ï¼š
ä»…åœ¨é¦–æ¬¡æ¸²æŸ“æ—¶åˆ›å»ºå¯¹è±¡ï¼Œåç»­çš„æ¯æ¬¡é‡æ–°æ¸²æŸ“ä¸­**å¤ç”¨åŒä¸€ä¸ªå¯¹è±¡**ï¼Œä¸ä¼šåˆ›å»ºæ–°çš„ ref å®ä¾‹ã€‚

* **ç±»ç»„ä»¶ï¼ˆcreateRefï¼‰**ï¼š
è°ƒç”¨æ—¶å°±ä¼šåˆ›å»ºæ–°çš„ ref å¯¹è±¡ï¼åˆ›å»ºæ—¶æœºã€æ¬¡æ•°å®Œå…¨ç”±ä»£ç å†³å®šï¼š
    * **åªæœ‰åœ¨ç±»ç»„ä»¶çš„ constructor ä¸­è°ƒç”¨ï¼Œå¹¶æŒ‚è½½åˆ°thisä¸Šï¼Œæ‰ä¼šå®ç°æŒä¹…åŒ–**ï¼Œå³ï¼šä»…åœ¨é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™åˆ›å»ºã€‚
        > ä¸ºä»€ä¹ˆè¦æŒ‚è½½åˆ°ç»„ä»¶å®ä¾‹thisä¸Šï¼Ÿ åªè¦ç»„ä»¶å®ä¾‹å­˜åœ¨ï¼Œref å¯¹è±¡å°±ä¼šä¸€ç›´å­˜åœ¨ï¼ˆæŒä¹…åŒ–ï¼‰ï¼Œä¸ä¼šéšrenderæ–¹æ³•çš„è°ƒç”¨è€Œé‡æ–°åˆ›å»ºã€‚
    * å…¶ä»–æƒ…å†µï¼Œå¦‚ å…¶ä»–æ–¹æ³•ï¼ˆå¦‚ renderã€äº‹ä»¶å¤„ç†å‡½æ•°ï¼‰ä¸­æŒ‚è½½åˆ°thisã€ç”¨å˜é‡å­˜å‚¨refå€¼ ä¸æŒ‚è½½åˆ°thisç­‰ç­‰ã€‚éƒ½æ˜¯æ–¹æ³•æ‰§è¡Œä¸€æ¬¡åˆ›å»ºä¸€æ¬¡ã€‚

éœ€æ³¨æ„ğŸ“¢ï¼š
1. **ä¸¤è€…çš„currentå±æ€§éƒ½å¯å­˜å‚¨ä»»æ„å˜é‡çš„å€¼**ï¼ˆå¦‚DOMå…ƒç´ ã€æ™®é€šå˜é‡ã€å®šæ—¶å™¨id...ï¼‰ï¼Œ  

2. **current å±æ€§æ”¹å˜æ—¶ï¼Œéƒ½ä¸ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“**ã€‚


ç¤ºä¾‹1ï¼šç±»ç»„ä»¶ä¸­å®ç°æŒä¹…åŒ–ï¼Œå¹¶ä¸”ç”¨ ref.current å­˜å‚¨æ•°æ®
```js
class xx extends Component {
 constructor(props) {
    super(props);
    // åˆ›å»ºrefå¹¶æŒ‚è½½åˆ°å®ä¾‹å±æ€§ä¸Š
    this.timerRef = createRef(null); 
 }
  componentDidMount() {
    // å°†å®šæ—¶å™¨IDå­˜å‚¨åˆ°timerRef.currentä¸­ï¼Œå®šæ—¶å™¨IDæ”¹å˜  ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“
    this.timerRef.current = setInterval(() => {
      this.setState((prevState) => ({
        count: prevState.count + 1
      }));
    }, 1000);
  }

  componentWillUnmount() {
    // ç»„ä»¶å¸è½½æ—¶ï¼Œé€šè¿‡å­˜å‚¨çš„å®šæ—¶å™¨IDæ¸…é™¤å®šæ—¶å™¨
    clearInterval(this.timerRef.current); 
  }
  render() {
    return (<div>1111</div>)
  }
}
```

ç¤ºä¾‹2ï¼šç±»ç»„ä»¶ä¸­ä½¿ç”¨creareRefçš„å„ç§æ–¹å¼ï¼Œä»¥åŠæ˜¯å¦å®ç°äº†æŒä¹…åŒ–ï¼Ÿ
```js
class MyComponent extends React.Component {
  constructor(props) {
    super(props);
    // ç»„ä»¶åˆå§‹åŒ–æ—¶åˆ›å»ºï¼ˆä»…ä¸€æ¬¡ï¼‰
    this.ref1 = createRef(); 
  }

  handleClick = () => {
    // ç‚¹å‡»æ—¶åˆ›å»ºï¼ˆæ¯æ¬¡ç‚¹å‡»ç”Ÿæˆæ–°å¯¹è±¡ï¼‰
    const ref2 = createRef(); 
  };

  render() {
    // æ¯æ¬¡æ¸²æŸ“æ—¶åˆ›å»ºï¼ˆæ¯æ¬¡æ¸²æŸ“ç”Ÿæˆæ–°å¯¹è±¡ï¼‰
    const ref3 = createRef(); 

    // åœ¨renderä¸­ï¼Œå³ä½¿æŒ‚è½½åˆ°thisï¼ˆæ¯æ¬¡æ¸²æŸ“ç”Ÿæˆæ–°å¯¹è±¡ï¼‰
    this.ref4 = createRef(); 

    return <div />;
  }
}
```

ç¤ºä¾‹3ï¼šuseRef åˆ›å»ºrefï¼Œå¹¶ç”¨å…¶currentå±æ€§å­˜å€¼
```js
import React, { useRef } from 'react';

function MyComponent() {
  const inputRef = useRef(null); // åˆ›å»º refï¼Œåˆå§‹å€¼ä¸º null
  const countRef = useRef(0); // ç”¨ ref å­˜å‚¨å¯å˜å€¼

  const focusInput = () => {
    inputRef.current.focus(); // è®¿é—® DOM å…ƒç´ 
  };

  const increment = () => {
    countRef.current++; // ä¿®æ”¹ ref ä¸­çš„å€¼ï¼Œä¸ä¼šè§¦å‘é‡æ¸²æŸ“
    console.log('è®¡æ•°:', countRef.current);
  };

  return (
    <div>
      <input ref={inputRef} type="text" />
      <button onClick={focusInput}>èšç„¦è¾“å…¥æ¡†</button>
      <button onClick={increment}>å¢åŠ è®¡æ•°</button>
    </div>
  );
}
```

## æ—§ç‰ˆ
æ—§ç‰ˆ refsï¼ˆå­—ç¬¦ä¸² ref æˆ– this.refsï¼‰
* å­—ç¬¦ä¸² refï¼ˆå·²åºŸå¼ƒï¼‰ï¼š   
å¦‚ ```<input ref="myInput" />```ï¼Œéœ€è¦ React å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå…¨å±€æ˜ å°„è¡¨ï¼ˆå°†å­—ç¬¦ä¸²é”®ä¸ DOM/ç»„ä»¶å®ä¾‹å…³è”ï¼‰ï¼Œæ¯æ¬¡è®¿é—® this.refs.myInput æ—¶éœ€æŸ¥è¡¨ï¼Œå¢åŠ äº†é¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚

* this.refsï¼ˆä»å¯ç”¨ï¼Œä½†ä¸æ¨èï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬çš„ç±»ç»„ä»¶ï¼‰ï¼š   
ä»…å½“ ref ä½¿ç”¨å›è°ƒå‡½æ•°æˆ– createRef æ—¶æœ‰æ•ˆï¼›è‹¥ä½¿ç”¨å­—ç¬¦ä¸² refï¼Œthis.refs çš„è¡Œä¸ºå·²è¢«åºŸå¼ƒã€‚