# webpack-dev-server详解

Webpack 官方提供的开发服务器工具。

新建了个本地服务器、实时编译、文件内存系统、热更新、请求代理转发

webpack-dev-server相当于是以下几项的组合：
* webpack-dev-middleware（开发环境中实现**实时编译**，编译后的资源放在内存中 而非磁盘上，并将这些资源托管到开发服务器）、webpack-hot-middleware（热模块替换），这两项通常用于 Express/Koa 等 Node.js 服务器
* HotModuleReplacementPlugin 的核心作用是在编译时构建模块热更新的依赖图谱、分配模块 ID、注入热更新相关编译逻辑
* http-proxy-middleware：实现API 代理，解决开发环境跨域问题



HotModuleReplacementPlugin，Webpack 内置插件（无需额外安装），主要是在**编译时**构建模块热更新的依赖图谱、分配模块 ID、注入热更新相关编译逻辑，
1. 编译时为模块分配唯一 ID、构建依赖图谱；
2. 注入 module.hot 对象（供业务代码声明热更新逻辑）；
3. 生成「热更新 chunk」和「更新清单」（记录模块变化）；
4. 构建 HMR 所需的编译时机制。	

webpack-hot-middleware	第三方中间件（需额外安装），**运行时**桥梁，主要是在服务器和浏览器之间转发更新通知：	
1. 作为 Webpack Dev Server 与浏览器的「通信桥梁」；
2. 监听 Webpack 编译输出的热更新文件；
3. 通过 WebSocket 向浏览器发送「模块更新通知」；
4. 提供热更新资源的访问接口（让浏览器获取新模块代


### 本地服务器启动：
* 启动时会在**本地创建一个 HTTP 服务器**（默认使用 express），可以配置端口、主机、代理等服务器相关参数。
* 负责处理**浏览器的资源请求**

### 实时编译与内存文件系统：
* 集成了 Webpack 的编译能力，会监听文件变化
* 与普通构建不同，编译结果不会输出到磁盘，而是保存在内存中（使用 memory-fs 库）
    > 内存操作比磁盘 IO 更快，大幅提升开发效率

### 自动刷新、模块热替换（HMR）：
当监测到文件变化时，会增量编译，编译完成后，基于 WebSocket 向浏览器发送更新通知。浏览器收到通知后，替换修改的模块。
* 需要配合 HotModuleReplacementPlugin 插件使用
* 应用代码可以通过 module.hot API 自定义热更新逻辑

### 请求代理处理：
* 可以配置代理规则，将特定请求转发到后端服务器，解决了开发环境下的跨域问题
* 基于 http-proxy-middleware 实现