# webpack 中的压缩
[webpack中针对不同类型文件的，分别有哪些压缩插件？](https://www.doubao.com/thread/wf3b8e0dafe250462)

## 一、压缩
* **JS代码压缩**​：```TerserPlugin```，最流行的JS压缩器，支持ES6。不需要单独安装，生产模式下自动启用！(webpack 5已内置的默认压缩工具)，压缩时选项：
    > 是否移除注释extractComments、多进程并行构建parallel、是否启用混淆（压缩时是否保持类、函数的名称）。

* **CSS代码压缩​**：```css-minimizer-webpack-plugin​```，删除冗余空格、代码、注释，属性简写等，基于cssnano（专业 CSS 压缩工具）。 需配合 ```MiniCssExtractPlugin```（提取 CSS 为单独文件）使用，适合所有 CSS/SCSS/Less 项目

* **Html文件代码压缩**​：```HtmlWebpackPlugin```，配置其 minify 属性。设置了minify，实际会使用另一个插件```html-minifier-terser​```
```js
module.exports = {​
    ...​
    plugin:[​
        new HtmlwebpackPlugin({​
            ...​
            minify:{​
                minifyCSS:false, // 是否压缩css​
                collapseWhitespace:false, // 是否折叠空格​
                removeComments:true // 是否移除注释​
            }​
        })​
    ]​
}​
```
* **文件大小压缩**​：```compression-webpack-plugin```，减少http传输过程中宽带的损坏。

* **图片压缩**：```image-webpack-loader```， 一般来说，图片文件大小是远远要比 js 或者 css 文件大的，所以图片压缩较为重要。
* **自定义字体压缩**：FontminPlugin



## 二、CSS处理 增强配置
```JS
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
const CssMinimizerPlugin = require('css-minimizer-webpack-plugin');

module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        use: [
          MiniCssExtractPlugin.loader, // 生产环境提取CSS为单独文件
          'css-loader',
          'postcss-loader' // 自动添加浏览器前缀等
        ]
      },
      {
        test: /\.scss$/,
        use: [
          MiniCssExtractPlugin.loader,
          'css-loader',
          'sass-loader' // 处理Sass
        ]
      }
    ]
  },
  plugins: [
    new MiniCssExtractPlugin({
      filename: 'css/[name].[contenthash].css'
    })
  ],
  optimization: {
    minimizer: [
      '...', // 保留默认的JS压缩
      new CssMinimizerPlugin() // 压缩CSS
    ]
  }
};
```
