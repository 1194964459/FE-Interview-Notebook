# 基于 Webpack 做优化

参考：
https://www.doubao.com/chat/19110088049245698

## 如何用webpack来优化前端性能
用webpack优化前端性能是指优化webpack的输出结果，让打包的最终结果在浏览器运行快速高效。​ 

### 一、减小资源体积
**1. 压缩代码**：删除多余的代码、注释、简化代码的写法等等方式。可以利用webpack的UglifyJsPlugin和ParallelUglifyPlugin来压缩JS文件， 利用cssnano（css-loader?minimize）来压缩css​   
[压缩代码](./1.3.1__压缩.md)

**2. Tree Shaking**: 将代码中永远不会走到的片段删除掉。可以通过在启动webpack时追加参数--optimize-minimize来实现​   
[Tree Shaking](./1.3.3__Tree%20shaking.md)

**3. Code Splitting**: 将代码按路由、组件或逻辑拆分为多个 chunk，避免单文件过大。这样做到按需加载，充分利用浏览器缓存​   
[代码分离](./1.3.2__代码分离.md)

**4. 提取公共第三方库**: SplitChunksPlugin插件来进行公共模块抽取，利用浏览器缓存可以长期缓存这些无需频繁变动的公共代码​
    > SplitChunksPlugin 也属于 代码分离 的一种

* **利用CDN加速**: 在构建过程中，将*引用的静态资源路径*修改为CDN上对应的路径。可以利用webpack对于output参数和各loader的publicPath参数来修改资源路径​

### 二、提升加载效率
**1. 懒加载（Lazy Loading）**：非首屏资源（如图片、组件）延迟加载，减少首屏请求数。
* 组件懒加载：用 React.lazy、动态 import()。
* 图片懒加载：结合 html-loader 给图片添加 loading="lazy" 属性

**2. 预加载/预连接（Preload/Preconnect）**：
* 预加载：提前加载首屏必需的 JS/CSS，基于```preload-webpack-plugin```
* 预连接：提前建立 CDN 连接，减少 DNS 解析时间。
    ```js
    <link rel="preconnect" href="https://cdn.example.com">   
    ```
3. 利用CDN加速：将打包后的静态资源（JS、CSS、图片）部署到 CDN，通过 output.publicPath 配置 CDN 域名，利用就近节点提升加载速度。


### 三、其他优化
* 缓存策略：通过 contenthash 给文件名添加哈希（如 app.[contenthash].js），只有文件内容变化时哈希才更新，实现浏览器缓存复用。
* 减少编译时间：（间接提升开发效率，不直接影响前端性能，但优化构建流程），参考：[提高编译速度](./1.2__如何提高webpack构建速度.md)
