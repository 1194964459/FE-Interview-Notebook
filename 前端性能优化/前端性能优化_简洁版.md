# 前端性能优化

输入URL
URL解析
DNS查询：dns-prefetch
TCP连接建立：
    * 使用http2，支持多路复用、头部压缩、服务器推送，减少连接开销和延迟
    * TLS 1.3 协议，握手次数减少，也安全
    * 并行连接：单个域名的最大并发数是6个，使用多个域名 可以增加并发数
    * 同一域名 连接复用
        * HTTP/1.1 默认支持长连接，通过 Connection: keep-alive 
http请求发送
    * 单个请求的数据量少一点
        * 各种资源文件的**压缩、格式调整**，如：图片选用webP格式（同等画质下 体积更小）
        * **资源压缩**：JS/CSS 通过 Terser、CleanCSS 压缩，HTML 去除冗余空格；
    * 请求合并，减少HTTP请求：如雪碧图、使用字体图标、graphQL减少请求次数、不要用空的src/href
        > graphQL可将多次请求合并为1次请求，且只返回请求的字段 无冗余，需后端配合
    * 请求**优先级**：资源预加载preload和资源预读取prefetch
    * 缓存：强缓存、协商缓存

服务器端响应
    * CDN加速

前端渲染    
    * 优先加载关键资源、内容；首屏加载的话可以用服务端渲染
    * 懒加载：图片等用懒加载（loading="lazy"），避免首屏加载过多资源。
    * 静态资源CDN：就近分发
    * 避免CSS阻塞渲染，不要用@import
    * 避免JS阻塞渲染：defer、async、动态加载/按需加载 import()
    * CSS放在head中，JS文件放在body底部；`先外链，后本页`（避免样式覆盖等）
    * DOM层面**避免重绘、重排**：读写分离、不要频繁操作DOM、 使用transform、opacity、will-change等属性实现动画
    * 使用性能更好的**API**：使用requestAnimationFrame、requestIdleCallBack、Worke等
    * Service Worker离线缓存
    * 大数据渲染：分片加载、虚拟列表
    * Lighthouse、Performance 面板分析性能瓶颈


## 杂七杂八
